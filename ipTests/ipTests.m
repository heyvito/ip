//
//  ipTests.m
//  ipTests
//
//  Created by Victor Gama on 05/05/2018.
//  Copyright Â© 2018 Victor Gama. All rights reserved.
//

#import <XCTest/XCTest.h>
#import <ip/ip.h>

@interface ipTests : XCTestCase

@end

@implementation ipTests {
    NSArray<NSString *> *invalidIPv4;
    NSArray<NSString *> *invalidIPv6;
    NSDictionary<NSString *, NSArray<NSString *> *> *validIPv4;
    NSDictionary<NSString *, NSArray<NSString *> *> *validIPv6;
}

- (void)tearDown {
    // Put teardown code here. This method is called after the invocation of each test method in the class.
    [super tearDown];
}

- (long)executeTestForAddress:(NSString *)anAddress class:(NSString *)aClass andDescriptors:(NSArray<NSString *> *)descriptors skippingMerges:(BOOL)skipMerge {
    if(descriptors == nil || descriptors.count == 0 || skipMerge) {
        descriptors = @[aClass];
    } else {
        descriptors = [descriptors arrayByAddingObject:aClass];
    }
    return [self executeTestForAddress:anAddress withDescriptors:descriptors];
}

- (long)executeTestForAddress:(NSString *)anAddress withDescriptors:(NSArray<NSString *> *)descriptors {
    IPv4 *v4 = [[IPv4 alloc] initWithAddress:anAddress];
    IPv6 *v6 = [[IPv6 alloc] initWithAddress:anAddress];
    long tests = 0;
    for(NSString *descriptor in descriptors) {
        if([descriptor isEqualToString:@"valid-ipv4"]) {
            XCTAssertNotNil(v4.parsedAddress);
            XCTAssertEqual(4, v4.parsedAddress.count);
            XCTAssertGreaterThanOrEqual(v4.subnetMask, 0);
            XCTAssertLessThanOrEqual(v4.subnetMask, 128);
            XCTAssertNil(v4.error);
            XCTAssert(v4.valid);
            tests++;
        }
        
        if([descriptor isEqualToString:@"invalid-ipv4"]) {
            XCTAssertNotNil(v4.error);
            XCTAssertFalse(v4.valid);
            tests++;
        }
        
        if([descriptor isEqualToString:@"valid-ipv6"]) {
            XCTAssertNotNil(v6.zone);
            XCTAssertNotNil(v6.subnet);
            XCTAssertGreaterThanOrEqual(v6.subnetMask, 0);
            XCTAssertLessThanOrEqual(v6.subnetMask, 128);
            XCTAssertNotNil(v6.parsedAddress);
            XCTAssertEqual(8, v6.parsedAddress.count);
            XCTAssertNil(v6.error);
            XCTAssert(v6.valid);
        }
        
        if([descriptor isEqualToString:@"invalid-ipv6"]) {
            XCTAssertNotNil(v6.error);
            XCTAssertFalse(v6.valid);
            XCTAssertNil([v6 correctForm]);
            tests++;
        }
        
        if([descriptor isEqualToString:@"canonical"]) {
            XCTAssert(v6.canonical);
            tests++;
        }
        
        if([descriptor isEqualToString:@"correct"]) {
            XCTAssert(v6.correct);
            tests++;
        }
        
        if([descriptor isEqualToString:@"correct-ipv4"]) {
            XCTAssert(v4.correct);
            tests++;
        }
        
        if([descriptor isEqualToString:@"incorrect"]) {
            XCTAssertFalse(v6.correct);
            tests++;
        }
        
        if([descriptor isEqualToString:@"incorrect-ipv4"]) {
            XCTAssertFalse(v4.correct);
            tests++;
        }
        
        if([descriptor isEqualToString:@"has-subnet"]) {
            NSRegularExpression *regexp = [NSRegularExpression regularExpressionWithPattern:@"^/\\d{1,3}" options:0 error:nil];
            NSTextCheckingResult *result = [regexp firstMatchInString:v6.subnet options:0 range:NSMakeRange(0, v6.subnet.length)];
            XCTAssertNotNil(result);
            tests++;
        }
        
        if([descriptor isEqualToString:@"v4-in-v6"]) {
            XCTAssert(v6.v4);
            tests++;
        }
    }
    return tests;
}

- (void)testValidv4Addresses {
    NSArray<NSString *> *descriptors;
    long tests = 0;
    for(NSString *address in [validIPv4 allKeys]) {
        descriptors = validIPv4[address];
        tests += [self executeTestForAddress:address class:@"valid-ipv4" andDescriptors:descriptors skippingMerges:NO];
        tests += [self executeTestForAddress:address class:@"invalid-ipv6" andDescriptors:descriptors skippingMerges:YES];
    }
    NSLog(@"[testValidv4Addresses] Assertions: %li", tests);
}

- (void)testInvalidIPv4Addresses {
    long tests = 0;
    for(NSString *address in invalidIPv4) {
        tests += [self executeTestForAddress:address class:@"invalid-ipv4" andDescriptors:nil skippingMerges:NO];
    }
    NSLog(@"[testInvalidIPv4Addresses] Assertions: %li", tests);
}

- (void)testValidv6Addresses {
    NSArray<NSString *> *descriptors;
    long tests = 0;
    for(NSString *address in [validIPv6 allKeys]) {
        descriptors = validIPv6[address];
        tests += [self executeTestForAddress:address class:@"valid-ipv6" andDescriptors:descriptors skippingMerges:NO];
        tests += [self executeTestForAddress:address class:@"invalid-ipv4" andDescriptors:descriptors skippingMerges:YES];
    }
    NSLog(@"[testValidv6Addresses] Assertions: %li", tests);
}

- (void)testInvalidIPv6Addresses {
    long tests = 0;
    for(NSString *address in invalidIPv6) {
        tests += [self executeTestForAddress:address class:@"invalid-ipv6" andDescriptors:nil skippingMerges:NO];
    }
    NSLog(@"[testInvalidIPv6Addresses] Assertions: %li", tests);
}

- (void)setUp {
    [super setUp];
    invalidIPv4 = @[@" 127.0.0.1",
                    @"127.0.0.1 ",
                    @"127.0.0.1 127.0.0.1",
                    @"127.0.0.256",
                    @"127.0.0.1//1",
                    @"127.0.0.1/0x1",
                    @"127.0.0.1/-1",
                    @"127.0.0.1/ab",
                    @"127.0.0.1/",
                    @"127.0.0.256/32",
                    @"127.0.0.1/33",];
    invalidIPv6 = @[@"':10.0.0.1",
                    @"-1",
                    @"::1 ::1",
                    @"02001:0000:1234:0000:0000:C1C0:ABCD:0876",
                    @"1.2.3.4",
                    @"1.2.3.4:1111:2222:3333:4444::5555",
                    @"1.2.3.4:1111:2222:3333::5555",
                    @"1.2.3.4:1111:2222::5555",
                    @"1.2.3.4:1111::5555",
                    @"1.2.3.4::",
                    @"1.2.3.4::5555",
                    @"1111",
                    @"11112222:3333:4444:5555:6666:1.2.3.4",
                    @"11112222:3333:4444:5555:6666:7777:8888",
                    @"::1//64",
                    @"::1/0001",
                    @"1111:",
                    @"1111:1.2.3.4",
                    @"1111:2222",
                    @"1111:22223333:4444:5555:6666:1.2.3.4",
                    @"1111:22223333:4444:5555:6666:7777:8888",
                    @"1111:2222:",
                    @"1111:2222:1.2.3.4",
                    @"1111:2222:3333",
                    @"1111:2222:33334444:5555:6666:1.2.3.4",
                    @"1111:2222:33334444:5555:6666:7777:8888",
                    @"1111:2222:3333:",
                    @"1111:2222:3333:1.2.3.4",
                    @"1111:2222:3333:4444",
                    @"1111:2222:3333:44445555:6666:1.2.3.4",
                    @"1111:2222:3333:44445555:6666:7777:8888",
                    @"1111:2222:3333:4444:",
                    @"1111:2222:3333:4444:1.2.3.4",
                    @"1111:2222:3333:4444:5555",
                    @"1111:2222:3333:4444:55556666:1.2.3.4",
                    @"1111:2222:3333:4444:55556666:7777:8888",
                    @"1111:2222:3333:4444:5555:",
                    @"1111:2222:3333:4444:5555:1.2.3.4",
                    @"1111:2222:3333:4444:5555:6666",
                    @"1111:2222:3333:4444:5555:66661.2.3.4",
                    @"1111:2222:3333:4444:5555:66667777:8888",
                    @"1111:2222:3333:4444:5555:6666:",
                    @"1111:2222:3333:4444:5555:6666:00.00.00.00",
                    @"1111:2222:3333:4444:5555:6666:000.000.000.000",
                    @"1111:2222:3333:4444:5555:6666:1.2.3.4.5",
                    @"1111:2222:3333:4444:5555:6666:255.255.255255",
                    @"1111:2222:3333:4444:5555:6666:255.255255.255",
                    @"1111:2222:3333:4444:5555:6666:255255.255.255",
                    @"1111:2222:3333:4444:5555:6666:256.256.256.256",
                    @"1111:2222:3333:4444:5555:6666:7777",
                    @"1111:2222:3333:4444:5555:6666:77778888",
                    @"1111:2222:3333:4444:5555:6666:7777:",
                    @"1111:2222:3333:4444:5555:6666:7777:1.2.3.4",
                    @"1111:2222:3333:4444:5555:6666:7777:8888:",
                    @"1111:2222:3333:4444:5555:6666:7777:8888:1.2.3.4",
                    @"1111:2222:3333:4444:5555:6666:7777:8888:9999",
                    @"1111:2222:3333:4444:5555:6666:7777:8888::",
                    @"1111:2222:3333:4444:5555:6666:7777:::",
                    @"1111:2222:3333:4444:5555:6666::1.2.3.4",
                    @"1111:2222:3333:4444:5555:6666::8888:",
                    @"1111:2222:3333:4444:5555:6666:::",
                    @"1111:2222:3333:4444:5555:6666:::8888",
                    @"1111:2222:3333:4444:5555::7777:8888:",
                    @"1111:2222:3333:4444:5555::7777::",
                    @"1111:2222:3333:4444:5555::8888:",
                    @"1111:2222:3333:4444:5555:::",
                    @"1111:2222:3333:4444:5555:::1.2.3.4",
                    @"1111:2222:3333:4444:5555:::7777:8888",
                    @"1111:2222:3333:4444::5555:",
                    @"1111:2222:3333:4444::6666:7777:8888:",
                    @"1111:2222:3333:4444::6666:7777::",
                    @"1111:2222:3333:4444::6666::8888",
                    @"1111:2222:3333:4444::7777:8888:",
                    @"1111:2222:3333:4444::8888:",
                    @"1111:2222:3333:4444:::",
                    @"1111:2222:3333:4444:::6666:1.2.3.4",
                    @"1111:2222:3333:4444:::6666:7777:8888",
                    @"1111:2222:3333::5555:",
                    @"1111:2222:3333::5555:6666:7777:8888:",
                    @"1111:2222:3333::5555:6666:7777::",
                    @"1111:2222:3333::5555:6666::8888",
                    @"1111:2222:3333::5555::1.2.3.4",
                    @"1111:2222:3333::5555::7777:8888",
                    @"1111:2222:3333::6666:7777:8888:",
                    @"1111:2222:3333::7777:8888:",
                    @"1111:2222:3333::8888:",
                    @"1111:2222:3333:::",
                    @"1111:2222:3333:::5555:6666:1.2.3.4",
                    @"1111:2222:3333:::5555:6666:7777:8888",
                    @"1111:2222::4444:5555:6666:7777:8888:",
                    @"1111:2222::4444:5555:6666:7777::",
                    @"1111:2222::4444:5555:6666::8888",
                    @"1111:2222::4444:5555::1.2.3.4",
                    @"1111:2222::4444:5555::7777:8888",
                    @"1111:2222::4444::6666:1.2.3.4",
                    @"1111:2222::4444::6666:7777:8888",
                    @"1111:2222::5555:",
                    @"1111:2222::5555:6666:7777:8888:",
                    @"1111:2222::6666:7777:8888:",
                    @"1111:2222::7777:8888:",
                    @"1111:2222::8888:",
                    @"1111:2222:::",
                    @"1111:2222:::4444:5555:6666:1.2.3.4",
                    @"1111:2222:::4444:5555:6666:7777:8888",
                    @"1111::3333:4444:5555:6666:7777:8888:",
                    @"1111::3333:4444:5555:6666:7777::",
                    @"1111::3333:4444:5555:6666::8888",
                    @"1111::3333:4444:5555::1.2.3.4",
                    @"1111::3333:4444:5555::7777:8888",
                    @"1111::3333:4444::6666:1.2.3.4",
                    @"1111::3333:4444::6666:7777:8888",
                    @"1111::3333::5555:6666:1.2.3.4",
                    @"1111::3333::5555:6666:7777:8888",
                    @"1111::4444:5555:6666:7777:8888:",
                    @"1111::5555:",
                    @"1111::5555:6666:7777:8888:",
                    @"1111::6666:7777:8888:",
                    @"1111::7777:8888:",
                    @"1111::8888:",
                    @"1111:::",
                    @"1111:::3333:4444:5555:6666:1.2.3.4",
                    @"1111:::3333:4444:5555:6666:7777:8888",
                    @"123",
                    @"12345::6:7:8",
                    @"124.15.6.89/60",
                    @"1:2:3:4:5:6:7:8:9",
                    @"1:2:3::4:5:6:7:8:9",
                    @"1:2:3::4:5::7:8",
                    @"1::1.2.256.4",
                    @"1::1.2.3.256",
                    @"1::1.2.3.300",
                    @"1::1.2.3.900",
                    @"1::1.2.300.4",
                    @"1::1.2.900.4",
                    @"1::1.256.3.4",
                    @"1::1.300.3.4",
                    @"1::1.900.3.4",
                    @"1::256.2.3.4",
                    @"1::260.2.3.4",
                    @"1::2::3",
                    @"1::300.2.3.4",
                    @"1::300.300.300.300",
                    @"1::3000.30.30.30",
                    @"1::400.2.3.4",
                    @"1::5:1.2.256.4",
                    @"1::5:1.2.3.256",
                    @"1::5:1.2.3.300",
                    @"1::5:1.2.3.900",
                    @"1::5:1.2.300.4",
                    @"1::5:1.2.900.4",
                    @"1::5:1.256.3.4",
                    @"1::5:1.300.3.4",
                    @"1::5:1.900.3.4",
                    @"1::5:256.2.3.4",
                    @"1::5:260.2.3.4",
                    @"1::5:300.2.3.4",
                    @"1::5:300.300.300.300",
                    @"1::5:3000.30.30.30",
                    @"1::5:400.2.3.4",
                    @"1::5:900.2.3.4",
                    @"1::900.2.3.4",
                    @"1:::3:4:5",
                    @"2001:0000:1234: 0000:0000:C1C0:ABCD:0876",
                    @"2001:0000:1234:0000:00001:C1C0:ABCD:0876",
                    @"2001:0000:1234:0000:0000:C1C0:ABCD:0876  0",
                    @"2001:1:1:1:1:1:255Z255X255Y255",
                    @"2001::FFD3::57ab",
                    @"2001:DB8:0:0:8:800:200C:417A:221",
                    @"2001:db8:85a3::8a2e:37023:7334",
                    @"2001:db8:85a3::8a2e:370k:7334",
                    @"3ffe:0b00:0000:0001:0000:0000:000a",
                    @"3ffe:b00::1::a",
                    @":",
                    @":1.2.3.4",
                    @":1111:2222:3333:4444:5555:6666:1.2.3.4",
                    @":1111:2222:3333:4444:5555:6666:7777:8888",
                    @":1111:2222:3333:4444:5555:6666:7777::",
                    @":1111:2222:3333:4444:5555:6666::",
                    @":1111:2222:3333:4444:5555:6666::8888",
                    @":1111:2222:3333:4444:5555::",
                    @":1111:2222:3333:4444:5555::1.2.3.4",
                    @":1111:2222:3333:4444:5555::7777:8888",
                    @":1111:2222:3333:4444:5555::8888",
                    @":1111:2222:3333:4444::",
                    @":1111:2222:3333:4444::1.2.3.4",
                    @":1111:2222:3333:4444::5555",
                    @":1111:2222:3333:4444::6666:1.2.3.4",
                    @":1111:2222:3333:4444::6666:7777:8888",
                    @":1111:2222:3333:4444::7777:8888",
                    @":1111:2222:3333:4444::8888",
                    @":1111:2222:3333::",
                    @":1111:2222:3333::1.2.3.4",
                    @":1111:2222:3333::5555",
                    @":1111:2222:3333::5555:6666:1.2.3.4",
                    @":1111:2222:3333::5555:6666:7777:8888",
                    @":1111:2222:3333::6666:1.2.3.4",
                    @":1111:2222:3333::6666:7777:8888",
                    @":1111:2222:3333::7777:8888",
                    @":1111:2222:3333::8888",
                    @":1111:2222::",
                    @":1111:2222::1.2.3.4",
                    @":1111:2222::4444:5555:6666:1.2.3.4",
                    @":1111:2222::4444:5555:6666:7777:8888",
                    @":1111:2222::5555",
                    @":1111:2222::5555:6666:1.2.3.4",
                    @":1111:2222::5555:6666:7777:8888",
                    @":1111:2222::6666:1.2.3.4",
                    @":1111:2222::6666:7777:8888",
                    @":1111:2222::7777:8888",
                    @":1111:2222::8888",
                    @":1111::",
                    @":1111::1.2.3.4",
                    @":1111::3333:4444:5555:6666:1.2.3.4",
                    @":1111::3333:4444:5555:6666:7777:8888",
                    @":1111::4444:5555:6666:1.2.3.4",
                    @":1111::4444:5555:6666:7777:8888",
                    @":1111::5555",
                    @":1111::5555:6666:1.2.3.4",
                    @":1111::5555:6666:7777:8888",
                    @":1111::6666:1.2.3.4",
                    @":1111::6666:7777:8888",
                    @":1111::7777:8888",
                    @":1111::8888",
                    @":2222:3333:4444:5555:6666:1.2.3.4",
                    @":2222:3333:4444:5555:6666:7777:8888",
                    @":3333:4444:5555:6666:1.2.3.4",
                    @":3333:4444:5555:6666:7777:8888",
                    @":4444:5555:6666:1.2.3.4",
                    @":4444:5555:6666:7777:8888",
                    @":5555:6666:1.2.3.4",
                    @":5555:6666:7777:8888",
                    @":6666:1.2.3.4",
                    @":6666:7777:8888",
                    @":7777:8888",
                    @":8888",
                    @"::-1",
                    @"::.",
                    @"::..",
                    @"::...",
                    @"::...4",
                    @"::..3.",
                    @"::..3.4",
                    @"::.2..",
                    @"::.2.3.",
                    @"::.2.3.4",
                    @"::1...",
                    @"::1.2..",
                    @"::1.2.256.4",
                    @"::1.2.3.",
                    @"::1.2.3.256",
                    @"::1.2.3.300",
                    @"::1.2.3.900",
                    @"::1.2.300.4",
                    @"::1.2.900.4",
                    @"::1.256.3.4",
                    @"::1.300.3.4",
                    @"::1.900.3.4",
                    @"::1111:2222:3333:4444:5555:6666::",
                    @"::2222:3333:4444:5555:6666:7777:1.2.3.4",
                    @"::2222:3333:4444:5555:6666:7777:8888:",
                    @"::2222:3333:4444:5555:6666:7777:8888:9999",
                    @"::2222:3333:4444:5555:7777:8888::",
                    @"::2222:3333:4444:5555:7777::8888",
                    @"::2222:3333:4444:5555::1.2.3.4",
                    @"::2222:3333:4444:5555::7777:8888",
                    @"::2222:3333:4444::6666:1.2.3.4",
                    @"::2222:3333:4444::6666:7777:8888",
                    @"::2222:3333::5555:6666:1.2.3.4",
                    @"::2222:3333::5555:6666:7777:8888",
                    @"::2222::4444:5555:6666:1.2.3.4",
                    @"::2222::4444:5555:6666:7777:8888",
                    @"::256.2.3.4",
                    @"::260.2.3.4",
                    @"::300.2.3.4",
                    @"::300.300.300.300",
                    @"::3000.30.30.30",
                    @"::3333:4444:5555:6666:7777:8888:",
                    @"::400.2.3.4",
                    @"::4444:5555:6666:7777:8888:",
                    @"::5555:",
                    @"::5555:6666:7777:8888:",
                    @"::6666:7777:8888:",
                    @"::7777:8888:",
                    @"::8888:",
                    @"::900.2.3.4",
                    @":::",
                    @":::1.2.3.4",
                    @":::2222:3333:4444:5555:6666:1.2.3.4",
                    @":::2222:3333:4444:5555:6666:7777:8888",
                    @":::3333:4444:5555:6666:7777:8888",
                    @":::4444:5555:6666:1.2.3.4",
                    @":::4444:5555:6666:7777:8888",
                    @":::5555",
                    @":::5555:6666:1.2.3.4",
                    @":::5555:6666:7777:8888",
                    @":::6666:1.2.3.4",
                    @":::6666:7777:8888",
                    @":::7777:8888",
                    @":::8888",
                    @"::ffff:192x168.1.26",
                    @"::ffff:2.3.4",
                    @"::ffff:257.1.2.3",
                    @"FF01::101::2",
                    @"FF02:0000:0000:0000:0000:0000:0000:0000:0001",
                    @"XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:1.2.3.4",
                    @"XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX:XXXX",
                    @"a::b::c",
                    @"a::g",
                    @"a:a:a:a:a:a:a:a:a",
                    @"a:aaaaa::",
                    @"a:b",
                    @"a:b:c:d:e:f:g:0",
                    @"fe80:0000:0000:0000:0204:61ff:254.157.241.086",
                    @"ffff:",
                    @"ffff::ffff::ffff",
                    @"ffgg:ffff:ffff:ffff:ffff:ffff:ffff:ffff",
                    @"ldkfj",
                    @"::/129",
                    @"1000:://32",
                    @"::/",];
    validIPv4 = @{
                  @"001.002.003.004": @[@"incorrect-ipv4"],
                  @"127.0.0.1": @[@"correct-ipv4"],
                  @"127.0.0.1/02": @[@"incorrect-ipv4"],
                  @"127.0.0.1/32": @[@"correct-ipv4"],
                  @"255.255.255.255/32": @[@"correct-ipv4"],
                 };
    
    validIPv6 = @{
                  @"0000:0000:0000:0000:0000:0000:0000:0000/128": @[@"incorrect", @"canonical", @"has-subnet"],
                  @"0000:0000:0000:0000:0000:0000:0000:0000": @[@"incorrect", @"canonical"],
                  @"0000:0000:0000:0000:0000:0000:0000:0001": @[@"incorrect", @"canonical"],
                  @"0:0:0:0:0:0:0:0": @[@"incorrect"],
                  @"0:0:0:0:0:0:0:1": @[@"incorrect"],
                  @"0:0:0:0:0:0:0::": @[@"incorrect"],
                  @"0:0:0:0:0:0:13.1.68.3": @[@"incorrect", @"v4-in-v6"],
                  @"0:0:0:0:0:0::": @[@"incorrect"],
                  @"0:0:0:0:0::": @[@"incorrect"],
                  @"0:0:0:0:0:FFFF:129.144.52.38": @[@"incorrect", @"v4-in-v6"],
                  @"0:0:0:0:1:0:0:0": @[@"incorrect"],
                  @"0:0:0:0::": @[@"incorrect"],
                  @"0:0:0::": @[@"incorrect"],
                  @"0:0::": @[@"incorrect"],
                  @"0:1:2:3:4:5:6:7/001": @[@"incorrect", @"has-subnet"],
                  @"0:1:2:3:4:5:6:7/128": @[@"correct", @"has-subnet"],
                  @"0:1:2:3:4:5:6:7": @[@"correct"],
                  @"0::": @[@"incorrect"],
                  @"0:a:b:c:d:e:f::": @[@"incorrect"],
                  @"1080:0:0:0:8:800:200c:417a": @[@"incorrect"],
                  @"1080::8:800:200c:417a": @[@"correct"],
                  @"1111:2222:3333:4444:5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333:4444:5555:6666:7777:8888": @[@"correct"],
                  @"1111:2222:3333:4444:5555:6666:7777::": @[@"incorrect"],
                  @"1111:2222:3333:4444:5555:6666::": @[@"correct"],
                  @"1111:2222:3333:4444:5555:6666::8888": @[@"incorrect"],
                  @"1111:2222:3333:4444:5555::": @[@"correct"],
                  @"1111:2222:3333:4444:5555::123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333:4444:5555::7777:8888": @[@"incorrect"],
                  @"1111:2222:3333:4444:5555::8888": @[@"correct"],
                  @"1111:2222:3333:4444::": @[@"correct"],
                  @"1111:2222:3333:4444::123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333:4444::6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333:4444::6666:7777:8888": @[@"incorrect"],
                  @"1111:2222:3333:4444::7777:8888": @[@"correct"],
                  @"1111:2222:3333:4444::8888": @[@"correct"],
                  @"1111:2222:3333::": @[@"correct"],
                  @"1111:2222:3333::123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333::5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333::5555:6666:7777:8888": @[@"incorrect"],
                  @"1111:2222:3333::6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222:3333::6666:7777:8888": @[@"correct"],
                  @"1111:2222:3333::7777:8888": @[@"correct"],
                  @"1111:2222:3333::8888": @[@"correct"],
                  @"1111:2222::": @[@"correct"],
                  @"1111:2222::123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222::4444:5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222::4444:5555:6666:7777:8888": @[@"incorrect"],
                  @"1111:2222::5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222::5555:6666:7777:8888": @[@"correct"],
                  @"1111:2222::6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111:2222::6666:7777:8888": @[@"correct"],
                  @"1111:2222::7777:8888": @[@"correct"],
                  @"1111:2222::8888": @[@"correct"],
                  @"1111::": @[@"correct"],
                  @"1111::123.123.123.123": @[@"v4-in-v6"],
                  @"1111::3333:4444:5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111::3333:4444:5555:6666:7777:8888": @[@"incorrect"],
                  @"1111::4444:5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111::4444:5555:6666:7777:8888": @[@"correct"],
                  @"1111::5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111::5555:6666:7777:8888": @[@"correct"],
                  @"1111::6666:123.123.123.123": @[@"v4-in-v6"],
                  @"1111::6666:7777:8888": @[@"correct"],
                  @"1111::7777:8888": @[@"correct"],
                  @"1111::8888": @[@"correct"],
                  @"1:2:3:4:5:6:1.2.3.4": @[@"v4-in-v6"],
                  @"1:2:3:4:5:6:7:8": @[@"correct"],
                  @"1:2:3:4:5:6::": @[@"correct"],
                  @"1:2:3:4:5:6::8": @[@"incorrect"],
                  @"1:2:3:4:5::": @[@"correct"],
                  @"1:2:3:4:5::1.2.3.4": @[@"v4-in-v6"],
                  @"1:2:3:4:5::7:8": @[@"incorrect"],
                  @"1:2:3:4:5::8": @[@"correct"],
                  @"1:2:3:4::": @[@"correct"],
                  @"1:2:3:4::1.2.3.4": @[@"v4-in-v6"],
                  @"1:2:3:4::5:1.2.3.4": @[@"v4-in-v6"],
                  @"1:2:3:4::7:8": @[@"correct"],
                  @"1:2:3:4::8": @[@"correct"],
                  @"1:2:3::": @[@"correct"],
                  @"1:2:3::1.2.3.4": @[@"v4-in-v6"],
                  @"1:2:3::5:1.2.3.4": @[@"v4-in-v6"],
                  @"1:2:3::7:8": @[@"correct"],
                  @"1:2:3::8": @[@"correct"],
                  @"1:2::": @[@"correct"],
                  @"1:2::1.2.3.4": @[@"v4-in-v6"],
                  @"1:2::5:1.2.3.4": @[@"v4-in-v6"],
                  @"1:2::7:8": @[@"correct"],
                  @"1:2::8": @[@"correct"],
                  @"1::": @[@"correct"],
                  @"1::1.2.3.4": @[@"v4-in-v6"],
                  @"1::2:3": @[@"correct"],
                  @"1::2:3:4": @[@"correct"],
                  @"1::2:3:4:5": @[@"correct"],
                  @"1::2:3:4:5:6": @[@"correct"],
                  @"1::2:3:4:5:6:7": @[@"incorrect"],
                  @"1::5:1.2.3.4": @[@"v4-in-v6"],
                  @"1::5:11.22.33.44": @[@"v4-in-v6"],
                  @"1::7:8": @[@"correct"],
                  @"1::8": @[@"correct"],
                  @"2001:0000:1234:0000:0000:C1C0:ABCD:0876": @[@"incorrect"],
                  @"2001:0000:4136:e378:8000:63bf:3fff:fdd2": @[@"canonical"],
                  @"2001:0DB8:0000:CD30:0000:0000:0000:0000/60": @[@"incorrect", @"has-subnet"],
                  @"2001:0DB8:0:CD30::/60": @[@"incorrect", @"has-subnet"],
                  @"2001:0DB8::CD30:0:0:0:0/60": @[@"incorrect", @"has-subnet"],
                  @"2001:0db8:0000:0000:0000:0000:1428:57ab": @[],
                  @"2001:0db8:0000:0000:0000::1428:57ab": @[],
                  @"2001:0db8:0:0:0:0:1428:57ab": @[],
                  @"2001:0db8:0:0::1428:57ab": @[],
                  @"2001:0db8:1234:0000:0000:0000:0000:0000": @[],
                  @"2001:0db8:1234::": @[],
                  @"2001:0db8:1234:ffff:ffff:ffff:ffff:ffff": @[],
                  @"2001:0db8:85a3:0000:0000:8a2e:0370:7334": @[],
                  @"2001:0db8::1428:57ab": @[],
                  @"2001::CE49:7601:2CAD:DFFF:7C94:FFFE": @[@"incorrect"],
                  @"2001::CE49:7601:E866:EFFF:62C3:FFFE": @[@"incorrect"],
                  @"2001:DB8:0:0:8:800:200C:417A": @[@"incorrect"],
                  @"2001:DB8::8:800:200C:417A": @[@"incorrect"],
                  @"2001:db8:85a3:0:0:8a2e:370:7334": @[@"incorrect"],
                  @"2001:db8:85a3::8a2e:370:7334": @[@"correct"],
                  @"2001:db8::": @[@"correct"],
                  @"2001:db8::1428:57ab": @[@"correct"],
                  @"2001:db8:a::123": @[@"correct"],
                  @"2002::": @[@"correct"],
                  @"2608::3:5": @[@"correct"],
                  @"2608:af09:30:0:0:0:0:134": @[],
                  @"2608:af09:30::102a:7b91:c239:baff": @[],
                  @"2::10": @[@"correct"],
                  @"3ffe:0b00:0000:0000:0001:0000:0000:000a": @[@"canonical"],
                  @"7:6:5:4:3:2:1:0": @[@"correct"],
                  @"::": @[@"correct"],
                  @"::/128": @[@"correct", @"has-subnet"],
                  @"::0": @[],
                  @"::0:0": @[],
                  @"::0:0:0": @[],
                  @"::0:0:0:0": @[],
                  @"::0:0:0:0:0": @[],
                  @"::0:0:0:0:0:0": @[],
                  @"::0:0:0:0:0:0:0": @[],
                  @"::0:a:b:c:d:e:f": @[],
                  @"::1": @[],
                  @"::1/128": @[@"correct", @"has-subnet"],
                  @"::123.123.123.123": @[@"v4-in-v6"],
                  @"::13.1.68.3": @[@"v4-in-v6"],
                  @"::2222:3333:4444:5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"::2222:3333:4444:5555:6666:7777:8888": @[],
                  @"::2:3": @[],
                  @"::2:3:4": @[],
                  @"::2:3:4:5": @[],
                  @"::2:3:4:5:6": @[],
                  @"::2:3:4:5:6:7": @[],
                  @"::2:3:4:5:6:7:8": @[],
                  @"::3333:4444:5555:6666:7777:8888": @[],
                  @"::4444:5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"::4444:5555:6666:7777:8888": @[],
                  @"::5555:6666:123.123.123.123": @[@"v4-in-v6"],
                  @"::5555:6666:7777:8888": @[],
                  @"::6666:123.123.123.123": @[@"v4-in-v6"],
                  @"::6666:7777:8888": @[],
                  @"::7777:8888": @[],
                  @"::8": @[],
                  @"::8888": @[],
                  @"::FFFF:129.144.52.38": @[@"v4-in-v6"],
                  @"::ffff:0:0": @[],
                  @"::ffff:0c22:384e": @[],
                  @"::ffff:12.34.56.78": @[@"v4-in-v6"],
                  @"::ffff:192.0.2.128": @[@"v4-in-v6"],
                  @"::ffff:192.168.1.1": @[@"v4-in-v6"],
                  @"::ffff:192.168.1.26": @[@"v4-in-v6"],
                  @"::ffff:c000:280": @[],
                  @"FE80::/10": @[@"incorrect", @"has-subnet"],
                  @"FEC0::/10": @[@"incorrect", @"has-subnet"],
                  @"FF00::/8": @[@"incorrect", @"has-subnet"],
                  @"FF01:0:0:0:0:0:0:101": @[@"incorrect"],
                  @"FF01::101": @[@"incorrect"],
                  @"FF02:0000:0000:0000:0000:0000:0000:0001": @[@"incorrect"],
                  @"a:b:c:d:e:f:0::": @[@"incorrect"],
                  @"fe80:0000:0000:0000:0204:61ff:fe9d:f156": @[@"canonical"],
                  @"fe80:0:0:0:204:61ff:254.157.241.86": @[@"v4-in-v6"],
                  @"fe80:0:0:0:204:61ff:fe9d:f156": @[@"incorrect"],
                  @"fe80::": @[@"correct"],
                  @"fe80::1": @[@"correct"],
                  @"fe80::204:61ff:254.157.241.86": @[@"v4-in-v6"],
                  @"fe80::204:61ff:fe9d:f156": @[],
                  @"fe80::217:f2ff:254.7.237.98": @[@"v4-in-v6"],
                  @"fe80::217:f2ff:fe07:ed62": @[@"correct"],
                  @"fedc:ba98:7654:3210:fedc:ba98:7654:3210": @[@"correct", @"canonical"],
                  @"ff02::1": @[@"correct"],
                  @"ffff::": @[@"correct"],
                  @"ffff::3:5": @[@"correct"],
                  @"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff": @[@"correct", @"canonical"],
                  @"a:0::0:b": @[@"incorrect"],
                  @"a:0:0::0:b": @[@"incorrect"],
                  @"a:0::0:0:b": @[@"incorrect"],
                  @"a::0:0:b": @[@"incorrect"],
                  @"a::0:b": @[@"incorrect"],
                  @"a:0::b": @[@"incorrect"],
                  @"a:0:0::b": @[@"incorrect"]
                  };
}

@end
